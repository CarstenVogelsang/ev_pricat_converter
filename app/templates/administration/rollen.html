{% extends "administration/base.html" %}
{% from "macros/breadcrumb.html" import breadcrumb %}

{% block title %}Rollen - Administration - {{ branding.app_title }}{% endblock %}

{% block admin_content %}
{{ breadcrumb([
    {'label': 'Administration', 'url': url_for('admin.index'), 'icon': 'ti-settings'},
    {'label': 'Stammdaten', 'url': url_for('admin.stammdaten_uebersicht')},
    {'label': 'Rollen', 'icon': 'ti-shield-check'}
]) }}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0"><i class="ti ti-shield-check" style="color: #8b5cf6;"></i> Benutzerrollen</h2>
    <span class="badge bg-secondary">{{ rollen|length }} Rollen</span>
</div>

<div class="card">
    <div class="card-header">
        <i class="ti ti-list me-1"></i> Verfügbare Rollen
    </div>
    <div class="table-responsive">
        <table class="table table-hover mb-0">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Beschreibung</th>
                    <th class="text-center">Benutzer</th>
                </tr>
            </thead>
            <tbody>
                {% for rolle in rollen %}
                <tr>
                    <td><code>{{ rolle.id }}</code></td>
                    <td>
                        <strong>{{ rolle.name }}</strong>
                        {% if rolle.name == 'admin' %}
                        <span class="badge bg-danger ms-1">System</span>
                        {% elif rolle.name == 'mitarbeiter' %}
                        <span class="badge bg-primary ms-1">System</span>
                        {% elif rolle.name == 'kunde' %}
                        <span class="badge bg-success ms-1">System</span>
                        {% endif %}
                    </td>
                    <td class="text-muted">
                        {% if rolle.name == 'admin' %}
                        Vollzugriff auf alle Funktionen
                        {% elif rolle.name == 'mitarbeiter' %}
                        Interner Mitarbeiter mit erweiterten Rechten
                        {% elif rolle.name == 'kunde' %}
                        Externer Benutzer mit eingeschränktem Zugriff
                        {% else %}
                        -
                        {% endif %}
                    </td>
                    <td class="text-center">
                        <span class="badge bg-light text-dark">
                            {{ rolle.users|length }}
                        </span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="alert alert-info mt-4">
    <i class="ti ti-info-circle me-2"></i>
    <strong>Info:</strong> Rollen definieren die grundlegenden Zugriffsrechte im System.
    Die drei Standard-Rollen (admin, mitarbeiter, kunde) können nicht bearbeitet werden.
    Modul-spezifische Zugriffsrechte werden über die <a href="{{ url_for('admin.module') }}">Modul-Verwaltung</a> gesteuert.
</div>
{% endblock %}
