{% extends "base.html" %}
{% from "macros/icon_picker.html" import icon_picker_offcanvas %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Header with Recently Visited Quick Links -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="ti ti-settings"></i> Administration</h2>
        {% if recent_admin_pages %}
        <div class="d-flex gap-2 align-items-center">
            <span class="text-muted small me-2"><i class="ti ti-history"></i> Zuletzt:</span>
            {% for page in recent_admin_pages %}
            <a href="{{ page.page_url }}" class="btn btn-sm btn-outline-secondary"
               title="{{ page.page_title }} - {{ page.timestamp.strftime('%d.%m. %H:%M') if page.timestamp else '' }}">
                {{ page.page_title|truncate(20, True, '…') }}
            </a>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <!-- Tab Navigation -->
    <style>
        .admin-tabs .nav-link {
            font-size: 1.1rem;
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            color: #6c757d;
            border-bottom: 3px solid transparent;
        }
        .admin-tabs .nav-link:hover {
            color: #495057;
            border-color: #dee2e6;
        }
        .admin-tabs .nav-link.active {
            font-weight: 600;
            color: #0d6efd;
            background-color: rgba(13, 110, 253, 0.08);
            border-color: #0d6efd;
            border-bottom-width: 3px;
        }
        .admin-tabs .nav-link i {
            font-size: 1.2rem;
        }
    </style>
    <ul class="nav nav-tabs nav-fill mb-4 admin-tabs">
        <li class="nav-item">
            <a class="nav-link{% if admin_tab == 'module' or request.endpoint == 'admin.index' %} active{% endif %}"
               href="{{ url_for('admin.module_uebersicht') }}">
                <i class="ti ti-apps me-2"></i>Module
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if admin_tab == 'system' %} active{% endif %}"
               href="{{ url_for('admin.system') }}">
                <i class="ti ti-dashboard me-2"></i>System
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if admin_tab == 'stammdaten' %} active{% endif %}"
               href="{{ url_for('admin.stammdaten_uebersicht') }}">
                <i class="ti ti-database me-2"></i>Stammdaten
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if admin_tab == 'einstellungen' %} active{% endif %}"
               href="{{ url_for('admin.einstellungen_uebersicht') }}">
                <i class="ti ti-adjustments me-2"></i>Einstellungen
            </a>
        </li>
    </ul>

    <!-- Content -->
    <div class="tab-content">
        {% block admin_content %}{% endblock %}
    </div>
</div>

{# Icon Picker Offcanvas (für alle Admin-Seiten verfügbar) #}
{{ icon_picker_offcanvas() }}
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/icon-picker.js') }}"></script>
{% endblock %}
